@model VeganDetailsVM
@{ ViewBag.Title = "Recipe Details";}

<partial name="~/Views/Shared/_Header.cshtml" />


<div class="presentation">
    <h3>@Model.Title</h3>

    @foreach (var cat in Model.Categories)
    {
        <h6>@cat</h6>
    }

    @if (Model.IsSaved)
    {
        <input type="submit" id="btnSave" value="Unsave" />
    }
    else
    {
        <input type="submit" id="btnSave" value="Save" />
    }
    <br />
    <img src="@Model.RecImg" alt="recipe-img" style="width:500px; height:auto" />

    <div class="posted-by-user">
        <img src="@Model.UserImg" alt="user-img" style="width:50px; height:auto" />
        <h6>@Model.Username</h6>

        @if (Model.IsFollowing)
        {
            <input type="submit" id="btnFollow" value="Unfollow" />
        }
        else if (Model.IsUsersRecipe)
        {
            <p>This is your recipe!</p>
        }
        else
        {
            <input type="submit" id="btnFollow" value="Follow" />
        }
    </div>
</div>
<div class="ingredients">
    <h3>Ingredients</h3>
    <ul>
        @foreach (var ingr in Model.Ingredients)
        {
            <li>@ingr.Amount @ingr.Unit @ingr.Name</li>
        }
    </ul>
</div>
<div class="steps">
    <h3>Step by Step</h3>
    @foreach (var step in Model.Steps)
    {
        <input type="checkbox">@(step.SortOrder) @step.Instruction
    }
</div>

@section scripts
{
    <script>
        var recId = @Model.RecId;
        $("#btnSave").click(function () {
            var isSaved = $('#btnSave').val() == "Unsave";
            $.ajax({
                url: (isSaved) ? "/Unsave/" + recId : "/Save/" + recId,
                type: "GET",
                success: function (result) {
                    $('#btnSave').val(result);
                }
            });
        });
    </script>

    <script>
        var id = "@Model.UserId";
        $("#btnFollow").click(function () {
            var isFollowing = $('#btnFollow').val() == "Unfollow";
            $.ajax({
                url: (isFollowing) ? "/Unfollow/" + id : "/Follow/" + id,
                type: "GET",
                success: function (result) {
                    $('#btnFollow').val(result);
                }
            });
        });
    </script>
}